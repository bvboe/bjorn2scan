<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Vulnerability Dashboard</title>
        <script src="shared-scripts.js" defer></script>
        <script src="index-script.js" defer></script>
        <script type="text/javascript" src="jquery-3.7.1.js"></script>
        <script type="text/javascript" src="jquery.multi-select.js"></script>
        <link rel="stylesheet" href="styles.css">
        <link rel="stylesheet" href="multi-select-styles.css">
        <style>
            #namespaceFilter + .multi-select-container .multi-select-menu {
                right: 0;
                left: auto;
            }
        </style>
    </head>
    <body>
        <table width="100%">
            <tr>
                <td valign="top">
                    <table id="headerTable">
                        <thead>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </td>
                <td width="100%" valign="top">
                    <table width="100%">
                        <tr>
                            <td>
                                <h1><div id=clusterName>Cluster Name</div></h1>
                            </td>
                        </tr>
                        <tr>
                            <td align="right">
                                <table>
                                    <tr>
                                        <td style="text-align: left">
                                            <form>
                                                    <label for="namespaces"><b>Namespace:</b></label>
                                                    <select id="namespaceFilter" name="namespaces" multiple style="font-size: 1.5em; min-width: 300px;">
                                                    </select>
                                            </form>
                                        </td>
                                    </tr>
                                </table>
                            </td>

                        </tr>
                    </table>
                    <table>
                        <tr>
                            <td valign="top">
                                <div id="containerScanStatus">
                                    <h3>Container Scan Status</h3>
                                    <table id="containerScanStatusTable" class="listingTable">
                                        <thead>
                                        </thead>
                                        <tbody></tbody>
                                    </table>
                                </div>
                            </td>
                            <td valign="top">
                                <div id="nodeScanStatus">
                                    <h3>Node Scan Status</h3>
                                    <table id="nodeScanStatusTable" class="listingTable">
                                        <thead>
                                        </thead>
                                        <tbody></tbody>
                                    </table>
                                </div>
                            </td>
                        </tr>
                    </table>

                    <div id="namespaceSummary">
                        <h3>Namespace Summary</h3>
                        <div style="text-align: right; text-decoration: underline;"><b><a href="" id="namespaceCsvlink">Export to CSV</a></b></div>
                        <table id="namespaceSummaryTable" width="100%" class="listingTable">
                            <thead>
                                <tr>
                                    <th rowspan="2" class="sortable" data-sort-field="namespace" onclick="sortByColumn('namespace', loadNamespaceSummaryTable, 'namespaceSummaryTable')"><b>Namespace</b></th>
                                    <th rowspan="2" class="sortable" data-sort-field="scanned_containers" onclick="sortByColumn('scanned_containers', loadNamespaceSummaryTable, 'namespaceSummaryTable')"><b># Instances</b></th>
                                    <th colspan="6"><b>Average # Vulnerabilities Per Container Instance</b></th>
                                    <th rowspan="2" class="sortable" data-sort-field="avg_risk" onclick="sortByColumn('avg_risk', loadNamespaceSummaryTable, 'namespaceSummaryTable')"><b>Average Risk Score</b></th>
                                    <th rowspan="2" class="sortable" data-sort-field="avg_known_exploits" onclick="sortByColumn('avg_known_exploits', loadNamespaceSummaryTable, 'namespaceSummaryTable')"><b>Average # Known Exploits</b></th>
                                    <th rowspan="2" class="sortable" data-sort-field="avg_number_of_packages" onclick="sortByColumn('avg_number_of_packages', loadNamespaceSummaryTable, 'namespaceSummaryTable')"><b>Average # Packages</b></th>
                                </tr>
                                <tr>
                                    <th class="sortable" data-sort-field="avg_cves_critical" onclick="sortByColumn('avg_cves_critical', loadNamespaceSummaryTable, 'namespaceSummaryTable')"><b>Critical</b></th>
                                    <th class="sortable" data-sort-field="avg_cves_high" onclick="sortByColumn('avg_cves_high', loadNamespaceSummaryTable, 'namespaceSummaryTable')"><b>High</b></th>
                                    <th class="sortable" data-sort-field="avg_cves_medium" onclick="sortByColumn('avg_cves_medium', loadNamespaceSummaryTable, 'namespaceSummaryTable')"><b>Medium</b></th>
                                    <th class="sortable" data-sort-field="avg_cves_low" onclick="sortByColumn('avg_cves_low', loadNamespaceSummaryTable, 'namespaceSummaryTable')"><b>Low</b></th>
                                    <th class="sortable" data-sort-field="avg_cves_negligible" onclick="sortByColumn('avg_cves_negligible', loadNamespaceSummaryTable, 'namespaceSummaryTable')"><b>Negligible</b></th>
                                    <th class="sortable" data-sort-field="avg_cves_unknown" onclick="sortByColumn('avg_cves_unknown', loadNamespaceSummaryTable, 'namespaceSummaryTable')"><b>Unknown</b></th>
                                </tr>
                                </thead>
                                <tbody></tbody>
                        </table>
                        <br/>
                    </div>
                    <div id="distroSummary">
                        <h3>Container Distribution Summary</h3>
                        <div style="text-align: right; text-decoration: underline;"><b><a href="" id="distroCsvlink">Export to CSV</a></b></div>
                        <table id="distroSummaryTable" width="100%" class="listingTable">
                            <thead>
                                <tr>
                                    <th rowspan="2" class="sortable" data-sort-field="distro_display_name" onclick="sortByColumn('distro_display_name', loadDistroTable, 'distroSummaryTable')"><b>Container Distribution</b></th>
                                    <th rowspan="2" class="sortable" data-sort-field="scanned_containers" onclick="sortByColumn('scanned_containers', loadDistroTable, 'distroSummaryTable')"><b># Instances</b></th>
                                    <th colspan="6"><b>Average # Vulnerabilities Per Container Instance</b></th>
                                    <th rowspan="2" class="sortable" data-sort-field="avg_risk" onclick="sortByColumn('avg_risk', loadDistroTable, 'distroSummaryTable')"><b>Average Risk Score</b></th>
                                    <th rowspan="2" class="sortable" data-sort-field="avg_known_exploits" onclick="sortByColumn('avg_known_exploits', loadDistroTable, 'distroSummaryTable')"><b>Average # Known Exploits</b></th>
                                    <th rowspan="2" class="sortable" data-sort-field="avg_number_of_packages" onclick="sortByColumn('avg_number_of_packages', loadDistroTable, 'distroSummaryTable')"><b>Average # Packages</b></th>
                                </tr>
                                <tr>
                                    <th class="sortable" data-sort-field="avg_cves_critical" onclick="sortByColumn('avg_cves_critical', loadDistroTable, 'distroSummaryTable')"><b>Critical</b></th>
                                    <th class="sortable" data-sort-field="avg_cves_high" onclick="sortByColumn('avg_cves_high', loadDistroTable, 'distroSummaryTable')"><b>High</b></th>
                                    <th class="sortable" data-sort-field="avg_cves_medium" onclick="sortByColumn('avg_cves_medium', loadDistroTable, 'distroSummaryTable')"><b>Medium</b></th>
                                    <th class="sortable" data-sort-field="avg_cves_low" onclick="sortByColumn('avg_cves_low', loadDistroTable, 'distroSummaryTable')"><b>Low</b></th>
                                    <th class="sortable" data-sort-field="avg_cves_negligible" onclick="sortByColumn('avg_cves_negligible', loadDistroTable, 'distroSummaryTable')"><b>Negligible</b></th>
                                    <th class="sortable" data-sort-field="avg_cves_unknown" onclick="sortByColumn('avg_cves_unknown', loadDistroTable, 'distroSummaryTable')"><b>Unknown</b></th>
                                </tr>
                                </thead>
                                <tbody></tbody>
                        </table>
                        <br/>
                    </div>
                    <div id="nodeSummary">
                        <h3>Node Distribution Summary</h3>
                        <div style="text-align: right; text-decoration: underline;"><b><a href="/api/distro/node-summary?output=csv" id="nodeCsvlink">Export to CSV</a></b></div>
                        <table id="nodeSummaryTable" width="100%" class="listingTable">
                            <thead>
                                <tr>
                                    <th rowspan="2" class="sortable" data-sort-field="distro_display_name" onclick="sortByColumn('distro_display_name', loadNodeTable, 'nodeSummaryTable')"><b>Node Distribution</b></th>
                                    <th rowspan="2" class="sortable" data-sort-field="scanned_nodes" onclick="sortByColumn('scanned_nodes', loadNodeTable, 'nodeSummaryTable')"><b># Nodes</b></th>
                                    <th colspan="6"><b>Average # Vulnerabilities Per Kubernetes Node</b></th>
                                    <th rowspan="2" class="sortable" data-sort-field="avg_risk" onclick="sortByColumn('avg_risk', loadNodeTable, 'nodeSummaryTable')"><b>Average Risk Score</b></th>
                                    <th rowspan="2" class="sortable" data-sort-field="avg_known_exploits" onclick="sortByColumn('avg_known_exploits', loadNodeTable, 'nodeSummaryTable')"><b>Average # Known Exploits</b></th>
                                    <th rowspan="2" class="sortable" data-sort-field="avg_number_of_packages" onclick="sortByColumn('avg_number_of_packages', loadNodeTable, 'nodeSummaryTable')"><b>Average # Packages</b></th>
                                </tr>
                                <tr>
                                    <th class="sortable" data-sort-field="avg_cves_critical" onclick="sortByColumn('avg_cves_critical', loadNodeTable, 'nodeSummaryTable')"><b>Critical</b></th>
                                    <th class="sortable" data-sort-field="avg_cves_high" onclick="sortByColumn('avg_cves_high', loadNodeTable, 'nodeSummaryTable')"><b>High</b></th>
                                    <th class="sortable" data-sort-field="avg_cves_medium" onclick="sortByColumn('avg_cves_medium', loadNodeTable, 'nodeSummaryTable')"><b>Medium</b></th>
                                    <th class="sortable" data-sort-field="avg_cves_low" onclick="sortByColumn('avg_cves_low', loadNodeTable, 'nodeSummaryTable')"><b>Low</b></th>
                                    <th class="sortable" data-sort-field="avg_cves_negligible" onclick="sortByColumn('avg_cves_negligible', loadNodeTable, 'nodeSummaryTable')"><b>Negligible</b></th>
                                    <th class="sortable" data-sort-field="avg_cves_unknown" onclick="sortByColumn('avg_cves_unknown', loadNodeTable, 'nodeSummaryTable')"><b>Unknown</b></th>
                                </tr>
                                </thead>
                                <tbody></tbody>
                        </table>
                    </div>
                    <div style="text-align: right; text-decoration: underline; font-style: italic;"><a href="https://github.com/bvboe/bjorn2scan/" target="_blank">Bjorn2Scan</a></div>
                </td>
            </tr>
        </table>
    </body>
</html>